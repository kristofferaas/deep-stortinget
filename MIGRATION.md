# Migration from Next.js to TanStack Start

This document outlines the migration from Next.js to TanStack Start.

## Changes Made

### 1. Dependencies

**Removed:**

- `next`
- `eslint-config-next`

**Added:**

- `@tanstack/start` - The TanStack Start framework
- `@tanstack/react-router` - File-based routing
- `@tanstack/router-plugin` - Vite plugin for route generation
- `vinxi` - Build tool for TanStack Start
- `vite` - Module bundler
- `@vitejs/plugin-react` - React plugin for Vite
- `vite-tsconfig-paths` - Path resolution for TypeScript

### 2. Project Structure

**Old structure (Next.js):**

```
src/
  app/
    page.tsx
    layout.tsx
    cases/
      page.tsx
      [id]/
        page.tsx
```

**New structure (TanStack Start):**

```
app/
  routes/
    __root.tsx         (root layout)
    index.tsx          (home page)
    cases/
      index.tsx        (cases listing)
      $id.tsx          (case details with dynamic param)
  components/
  styles/
  client.tsx           (client entry point)
  server.tsx           (server entry point)
  router.tsx           (router configuration)
```

### 3. Environment Variables

**Changed:**

- `NEXT_PUBLIC_CONVEX_URL` → `VITE_CONVEX_URL`

Make sure to update your `.env` file:

```bash
VITE_CONVEX_URL=your-convex-url-here
```

### 4. Configuration Files

**Added:**

- `app.config.ts` - TanStack Start configuration
- `tsr.config.json` - TanStack Router plugin configuration

**Removed:**

- `next.config.ts`

**Updated:**

- `tsconfig.json` - Updated for TanStack Start/Vite
- `.gitignore` - Updated ignore patterns
- `eslint.config.mjs` - Removed Next.js specific config

### 5. Scripts

Updated `package.json` scripts:

- `dev`: `vinxi dev` (was `next dev --turbopack`)
- `build`: `vinxi build` (was `next build --turbopack`)
- `start`: `vinxi start` (was `next start`)

### 6. Routing Changes

**Navigation:**

- Next.js `Link` from `next/link` → TanStack Router `Link` from `@tanstack/react-router`
- Type-safe navigation with `to` prop and `params`/`search` objects

**Dynamic Routes:**

- Next.js: `[id]/page.tsx` → TanStack: `$id.tsx`

**Search Params:**

- Next.js: `useSearchParams()` hook → TanStack: `Route.useSearch()` with validation

**Route Params:**

- Next.js: `useParams()` → TanStack: `Route.useParams()`

### 7. Key API Differences

| Feature           | Next.js                  | TanStack Start                     |
| ----------------- | ------------------------ | ---------------------------------- |
| Route definition  | Export default component | `createFileRoute()` with config    |
| Root layout       | `layout.tsx`             | `__root.tsx`                       |
| Client components | `"use client"` directive | Not needed (all client by default) |
| Metadata          | `export const metadata`  | Route config options               |

## Running the Project

1. Install dependencies:

```bash
pnpm install
```

2. Set up environment variables:

```bash
# Copy and update with your Convex URL
cp .env.example .env
```

3. Run the development server:

```bash
pnpm dev
```

4. Build for production:

```bash
pnpm build
```

5. Start production server:

```bash
pnpm start
```

## Notes

- The route tree (`app/routeTree.gen.ts`) is auto-generated by the TanStack Router Vite plugin
- Build outputs go to `.vinxi` and `.output` directories (both gitignored)
- TanStack Start provides full-stack type safety with file-based routing
- All routes are automatically code-split
